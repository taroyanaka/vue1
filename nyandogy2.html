<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ç®¡ç†</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.37/dist/vue.global.js"></script>
    <style>
        .creature { margin: 20px; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <div id="app">
        <h1>ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ç®¡ç†</h1>
        <div v-for="creature in creatures" :key="creature.name" class="creature">
            <h2>{{ creature.emoji }} {{ creature.name }}</h2>
            <p>æº€è…¹åº¦: {{ creature.fu }}</p>
            <p>å¹¸ã›åº¦: {{ creature.ha }}</p>
            <p>ğŸ’©: {{ creature.poop }}</p>
            <p>æ®‹ã‚Šæ™‚é–“: {{ creature.rem }}</p>
            <p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {{ creature.message }}</p>
            <button @click="feed(creature)">é¤Œã‚’ã‚ã’ã‚‹</button>
            <button @click="play(creature)">éŠã¶</button>
            <button @click="toilet(creature)">ãƒˆã‚¤ãƒ¬</button>
            <button @click="evolve(creature)">é€²åŒ–</button>
        </div>
        <h3>ç·ğŸ’©æ•°: {{ totalPoopCount }}</h3>
    </div>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    creatures: [
                        { name: 'ã‚¤ã‚«ã©ã', emoji: 'ğŸ™', fu: 50, ha: 50, alive: true, poop: 0, type: 0, maxPoop: 10, ev: { fu: 70, ha: 70, poop: 10, newName: 'ã‚¤ã‚«å¤§ç‹', newEmoji: 'ğŸ‘‘' }, rem: 10, pb: 100, message: '' },
                        { name: 'ã‚¯ã‚¸ãƒ©ã©ã', emoji: 'ğŸ‹', fu: 50, ha: 50, alive: true, poop: 0, type: 1, maxPoop: 15, ev: { fu: 80, ha: 80, poop: 15, newName: 'ã‚¯ã‚¸ãƒ©å¸ç‹', newEmoji: 'ğŸ‘‘' }, rem: 10, pb: 100, message: '' },
                        { name: 'ã‚¦ãƒŸã‚¦ã‚·ã©ã', emoji: 'ğŸŒ', fu: 50, ha: 50, alive: true, poop: 0, type: 2, maxPoop: 20, ev: { fu: 90, ha: 90, poop: 20, newName: 'ã‚¦ãƒŸã‚¦ã‚·çš‡å¸', newEmoji: 'ğŸ‘‘' }, rem: 10, pb: 100, message: '' },
                        { name: 'æœªçŸ¥ã®ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼', emoji: 'ğŸ¦„', fu: 50, ha: 50, alive: true, poop: 0, type: 3, maxPoop: 30, ev: { fu: 100, ha: 100, poop: 30, newName: 'ç¥', newEmoji: 'ğŸ‘‘' }, rem: 10, pb: 100, message: '' },
                    ],
                    settings: { fd: 1, hd: 1, tm: 1 },
                    timer: null
                };
            },
            computed: {
                totalPoopCount() {
                    return this.creatures ? this.creatures.reduce((total, c) => total + c.poop, 0) : 0;
                }
            },
            methods: {
                feed(c) { if (!c.alive) return; c.fu = Math.min(c.fu + 10, 100); this.checkAlive(c); },
                play(c) { if (!c.alive) return; c.ha = Math.min(c.ha + 10, 100); this.checkAlive(c); },
                toilet(c) { if (!c.alive) return; c.poop = 0; this.checkAlive(c); }, // ğŸ’©ã‚’0ã«ãƒªã‚»ãƒƒãƒˆ
                evolve(c) {
                    const { fu, ha, poop, newName, newEmoji } = c.ev;
                    if (c.fu > 0 && c.poop < c.maxPoop && c.fu >= fu && c.ha >= ha) {
                        c.message = `${c.name}ãŒé€²åŒ–ã—ãŸï¼`;
                        c.name = newName;
                        c.emoji = newEmoji;
                        c.type += 1; // é€²åŒ–ã‚¿ã‚¤ãƒ—ã‚’å¢—ã‚„ã™
                        c.maxPoop -= 5; // é€²åŒ–ã”ã¨ã«ğŸ’©ã®ä¸Šé™ã‚’æ¸›å°‘
                    } else {
                        c.message = `${c.name}ã¯é€²åŒ–ã§ãã¾ã›ã‚“ã€‚æ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã¾ã›ã‚“ã€‚`;
                    }
                },
                checkAlive(c) {
                    if (c.fu <= 0 || c.poop >= c.maxPoop) {
                        c.alive = false;
                        c.message = `${c.name}ã¯äº¡ããªã‚Šã¾ã—ãŸã€‚`;
                    } else {
                        c.message = '';
                    }
                },
                startTimer() {
                    this.timer = setInterval(() => {
                        this.creatures.forEach(c => {
                            if (c.alive) {
                                // æ™‚é–“çµŒéã§æº€è…¹åº¦ã¨å¹¸ã›åº¦ã‚’æ¸›å°‘
                                c.fu = Math.max(c.fu - this.settings.fd, 0);
                                c.ha = Math.max(c.ha - this.settings.hd, 0);
                                c.rem -= this.settings.tm;

                                // ğŸ’©ã‚’å¢—åŠ 
                                c.poop += 1; // 1ç§’ã”ã¨ã«ğŸ’©ã‚’1ã¤å¢—ã‚„ã™
                                this.checkAlive(c); // ç”Ÿå­˜ãƒã‚§ãƒƒã‚¯

                                if (c.rem <= 0) {
                                    this.evolve(c); // é€²åŒ–ãƒã‚§ãƒƒã‚¯
                                    c.rem = 10; // æ®‹ã‚Šæ™‚é–“ã‚’ãƒªã‚»ãƒƒãƒˆ
                                }
                                c.pb = (c.rem / 10) * 100;
                            }
                        });
                    }, 1000);
                },
                stopTimer() { clearInterval(this.timer); this.timer = null; }
            },
            mounted() {
                this.startTimer(); // ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ã‚¿ã‚¤ãƒãƒ¼ã‚’é–‹å§‹
            },
            beforeUnmount() {
                this.stopTimer(); // ã‚¢ãƒ—ãƒªçµ‚äº†æ™‚ã«ã‚¿ã‚¤ãƒãƒ¼ã‚’åœæ­¢
            }
        });

        app.mount('#app');
    </script>
</body>
</html>
